var Email={send:function(a){return new Promise(function(n,e){a.nocache=Math.floor(1e6*Math.random()+1),a.Action="Send";var t=JSON.stringify(a);Email.ajaxPost("https://smtpjs.com/v3/smtpjs.aspx?",t,function(e){n(e)})})},ajaxPost:function(e,n,t){var a=Email.createCORSRequest("POST",e);a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onload=function(){var e=a.responseText;null!=t&&t(e)},a.send(n)},ajax:function(e,n){var t=Email.createCORSRequest("GET",e);t.onload=function(){var e=t.responseText;null!=n&&n(e)},t.send()},createCORSRequest:function(e,n){var t=new XMLHttpRequest;return"withCredentials"in t?t.open(e,n,!0):"undefined"!=typeof XDomainRequest?(t=new XDomainRequest).open(e,n):t=null,t}};(function($){var ajaxQueue=$({});$.ajaxQueue=function(ajaxOpts){var jqXHR,dfd=$.Deferred(),promise=dfd.promise();ajaxQueue.queue(doRequest);promise.abort=function(statusText){if(jqXHR){return jqXHR.abort(statusText);}
var queue=ajaxQueue.queue(),index=$.inArray(doRequest,queue);if(index>-1){queue.splice(index,1);}
dfd.rejectWith(ajaxOpts.context||ajaxOpts,[promise,statusText,""]);return promise;};function doRequest(next){jqXHR=$.ajax(ajaxOpts).done(dfd.resolve).fail(dfd.reject).then(next,next);}
return promise;};})(jQuery);(function($){$.fn.jsErrorHandler=function(options){if(options)
$.extend(settings,options);window.onerror=function(err,url,line){var msg='Error: '+err+'<br />'+'Url: '+url+'<br />'+'Line: '+line+'<br />'+'UserAgent: '+navigator.userAgent+'<br />';console.log(msg);Email.send({SecureToken:"32c7f03a-0ef8-4af4-ad6d-50446e811fb3",To:'christelle.zielinski@univ-amu.fr',From:"The Spy <christelle.zielinski@univ-amu.fr>",Subject:"Metaphor -- js error",Body:msg}).then(function(){var emsg="<div class='jspsych-display-element' style='margin-top:3em'><span class='large center-content'><p>Merci d'avoir bien voulu participer !</p>"+"<p>L'expérience ne se lance malheureusement pas correctement, peut-être à cause d'une trop forte affluence.</p>"+"<p>Un rapport d'erreur a été envoyé pour nous permettre de corriger les scripts si nécessaire...</p>"+"<p>N'hésitez pas à retenter plus tard ! </p> </span></div>";$("body").html(emsg);});return true;};};})(jQuery);